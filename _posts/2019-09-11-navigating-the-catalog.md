---
layout: post
title:  "JSS Commerce part 2 - Navigating the catalog"
date: 2019-09-11 10:14
author: jonnekats
comments: true
keywords: Sitecore 9, SXC9, commerce, JSS, sitecore, javascript services
categories: [Sitecore]
---
In [part 1](../exposing-the-commerce-engine) I described how we chose to expose the commerce engine in our JSS commerce experiment. In this part I will talk about how we implemented catalog navigation. 

As discussed in part 1, we decided to expose the commerce engine using an API gateway instead of creating a custom endpoint. This also means that we don't go through Sitecore commerce connect. We could choose to also access the catalog commerce engine API directly from JSS, but how would the content editor be able to use the experience editor to edit category and product pages? For this reason, we chose to still use the data provider that is part of commerce connect. 

When you install commerce connect, the catalog data provider is available at the following location:

![catalog structure](/assets/images/navigating-the-catalog/catalog-location.jpg)

One way to make these catalog items available, is by created a custom item resolver for the `httpRequestBegin` pipeline. This resolver parses the current URL and maps it to a category or product from the catalog, which is set to `Context.Item`. After this Sitecore will serve the catalog item and the related layout. This requires custom coding, but offers a lot of flexibility in terms of the url structure you would like to use. This is also how the SXA storefront used to do it using the [wild card navigation](https://doc.sitecore.com/users/91/sitecore-experience-commerce/en/navigation-methods.html). 

Since 9.1 the SXA storefront has a new default type of navigation: [direct navigation](https://doc.sitecore.com/users/91/sitecore-experience-commerce/en/enable-direct-navigation.html). We are not using SXA, so we cannot use it. But it is really easy to implement with a simple ~~hack~~ trick. What the SXA storefront does when you enable direct navigation: it adds an item based on the `Commerce Catalog Folder` to the content tree. It turns out we can just do this manually. Just add a new item based on the `/sitecore/templates/Commerce/Catalog/Commerce Catalog Folder` template to a location under the site root level and enable the catalog that you would like to use.

![catalog folder](/assets/images/navigating-the-catalog/catalog-folder.jpg)

In our case I called the item `catalogs` and the catalog urls will look like this: `/catalogs/Habitat_Master/Habitat_Master-Departments/Habitat_Master-Appliances`. To make sure that the items are working with JSS, we need to modify the template hierarchy of the catalog items to include the `/sitecore/templates/Project/app/App Route` template. This template is generated by JSS when you [deploy the app to Sitecore](https://jss.sitecore.com/docs/getting-started/app-deployment). You don't have to modify the out-of-the-box commerce templates, but you can create custom templates that derive from the default templates. For example, create a custom category template that derives from `/sitecore/templates/Commerce/Catalog/Commerce Category`. Also add the project specific App Route `/sitecore/templates/Project/app/App Route` to its base templates. After this, select the catalog and configure the template in Templates overrides: 

![catalog folder](/assets/images/navigating-the-catalog/templates.jpg)

You can now add standard values for the custom template and configure the presentation details. After this you should be able to navigate the catalog, no code involved!